# 项目备忘录

微观的开发记录，像是项目的"航海日志"

## 已完成事项 ✓

1. 项目初始化
   - [x] 创建GitHub仓库
   - [x] 基于beta-DPO设置基础代码结构
   - [x] 更新README.md
   - [x] 建立文档结构

2. 理论准备
   - [x] 整理信息融合算子的基础知识
   - [x] 总结常见融合算子的特点和应用场景
   - [x] 分析信息融合在LLM训练中的应用可能
   - [x] 理解 HH 数据集在 SFT 和 DPO 中的双重作用:
     * SFT: 使用 (prompt, chosen) 对进行基础指令对齐
     * DPO: 使用完整的 (prompt, chosen, rejected) 三元组进行偏好优化

3. 代码基础
   - [x] 优化项目结构，分离基线代码和研究代码
   - [x] 完成beta-DPO基线方法的数学推导文档
   - [x] 建立可学习beta方法的文档框架

4. 初始尝试与调整
   - [x] 尝试直接修改beta-DPO代码:
     * 分析了trainers.py中的数据处理逻辑
     * 尝试提取数据处理部分到独立模块
     * 发现工程复杂度较高，需要处理很多依赖和兼容性问题
   - [x] 决定转向使用llama-factory:
     * 原因：
       1. beta-DPO代码修改成本高，需要处理很多工程细节
       2. llama-factory提供完整的训练流程和工具链
       3. 可以更专注于核心创新点的验证
       4. 社区支持好，文档完善
     * 经验教训：
       1. 在进行深度修改前应该先评估工程成本
       2. 优先使用成熟的工具链，避免重复造轮子
       3. 保留初始尝试的经验，可能对后续改进有帮助

## 进行中 🚧

1. 开发策略调整
   - [x] 决定使用llama-factory作为实验平台
   - [ ] 设计llama-factory的配置文件
   - [ ] 准备数据集转换脚本
   - [ ] 规划实验流程:
     * 基线DPO实验
     * beta-DPO对比实验
     * 信息融合方法验证

2. 理论框架
   - [ ] 完善信息融合视角的理论推导
   - [ ] 编写信息融合理论文档
   - [ ] 设计动态β的数学形式

3. 实验准备
   - [ ] 使用llama-factory完成基准DPO训练
   - [ ] 收集和分析实验数据
   - [ ] 验证理论假设
   - [ ] 规划beta-DPO改进的集成方案

4. 数据准备
   - [ ] 下载 Anthropic HH-RLHF 数据集
   - [ ] 转换数据为llama-factory支持的格式
   - [ ] 验证数据格式和质量
   - [ ] 准备训练/测试集切分

## 待办事项 📝

1. 文档完善
   - [ ] 编写基础知识文档
   - [ ] 补充实验记录模板
   - [ ] 添加API文档
   - [ ] 记录llama-factory使用经验

2. 实验设计
   - [ ] 设计对比实验方案
   - [ ] 准备实验数据集
   - [ ] 实现新的评估指标
   - [ ] 设计llama-factory的实验配置

3. 实验优化
   - [ ] 设计消融实验
   - [ ] 添加可视化工具
   - [ ] 优化训练效率
   - [ ] 分析llama-factory训练日志

4. 论文写作
   - [ ] 完善理论分析部分
   - [ ] 补充实验结果
   - [ ] 改进图表展示

## 问题记录 ❓

1. 理论问题
   - 如何形式化描述信息融合过程?
   - 动态β的取值范围如何确定?
   - 如何选择合适的信息融合算子?
   - 如何在llama-factory框架下实现我们的改进?

2. 实现问题
   - 动态β的计算开销如何控制?
   - 如何保证训练稳定性?
   - 如何在llama-factory中添加自定义训练逻辑?
   - 如何确保实验的可复现性?

## 备注 📌

1. 重要日期
   - 项目启动: 2024-03-xx
   - 第一阶段截止: 2024-04-xx

2. 参考资源
   - [beta-DPO论文](https://github.com/junkangwu/beta-DPO)
   - [llama-factory文档](https://github.com/hiyouga/LLaMA-Factory)
   - [信息融合相关工作]()
   - [Information Fusion in Machine Learning](https://link.springer.com/book/10.1007/978-3-319-17622-5) 

3. 开发策略
   - 使用llama-factory作为主要实验平台
   - 专注于核心创新点的验证
   - 成功后考虑将改进集成到llama-factory
   - 保持代码和实验的可复现性 